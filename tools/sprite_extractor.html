<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>ç²¾çµå›¾æ‰¹é‡è£å‰ªå·¥å…·</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #1a1a2e;
            color: #fff;
        }
        h1, h2 { color: #4ecdc4; }
        .section {
            margin: 20px 0;
            padding: 15px;
            background: #2a2a3e;
            border-radius: 8px;
        }
        button {
            padding: 10px 20px;
            margin: 5px;
            background: #4ecdc4;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
        }
        button:hover { background: #3dbdb5; }
        .preview {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }
        .sprite-item {
            text-align: center;
            background: #3a3a4e;
            padding: 10px;
            border-radius: 5px;
        }
        .sprite-item canvas {
            image-rendering: pixelated;
            border: 1px solid #4ecdc4;
        }
        .sprite-item p {
            margin: 5px 0 0;
            font-size: 12px;
        }
        #status {
            padding: 10px;
            background: #333;
            border-radius: 5px;
            margin: 10px 0;
        }
        .download-link {
            display: inline-block;
            padding: 5px 10px;
            background: #27ae60;
            color: white;
            text-decoration: none;
            border-radius: 3px;
            margin: 2px;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <h1>ğŸ® ç²¾çµå›¾æ‰¹é‡è£å‰ªå·¥å…·</h1>

    <div class="section">
        <h2>æ“ä½œè¯´æ˜</h2>
        <p>ç‚¹å‡»ä¸‹æ–¹æŒ‰é’®ï¼Œå°†è‡ªåŠ¨ä»ç²¾çµå›¾ä¸­è£å‰ªå‡ºæ‰€éœ€å›¾ç‰‡å¹¶æä¾›ä¸‹è½½ã€‚</p>
        <p>ä¸‹è½½åè¯·å°†æ–‡ä»¶æ”¾å…¥å¯¹åº”çš„ assets æ–‡ä»¶å¤¹ä¸­ã€‚</p>
    </div>

    <div class="section">
        <h2>1. è§’è‰²ç²¾çµ (assets/players/)</h2>
        <button onclick="extractPlayers()">è£å‰ªè§’è‰²ç²¾çµ</button>
        <div id="playersPreview" class="preview"></div>
    </div>

    <div class="section">
        <h2>2. æ•Œäººç²¾çµ (assets/enemies/)</h2>
        <button onclick="extractEnemies()">è£å‰ªæ•Œäººç²¾çµ</button>
        <div id="enemiesPreview" class="preview"></div>
    </div>

    <div class="section">
        <h2>3. Bossç²¾çµ (assets/bosses/)</h2>
        <button onclick="extractBosses()">è£å‰ªBossç²¾çµ</button>
        <div id="bossesPreview" class="preview"></div>
    </div>

    <div class="section">
        <h2>4. æ­¦å™¨ç²¾çµ (assets/weapons/)</h2>
        <button onclick="extractWeapons()">è£å‰ªæ­¦å™¨ç²¾çµ</button>
        <div id="weaponsPreview" class="preview"></div>
    </div>

    <div class="section">
        <h2>5. é“å…·ç²¾çµ (assets/items/)</h2>
        <button onclick="extractItems()">è£å‰ªé“å…·ç²¾çµ</button>
        <div id="itemsPreview" class="preview"></div>
    </div>

    <div class="section">
        <button onclick="extractAll()" style="background: #e74c3c; font-size: 16px; padding: 15px 30px;">
            ğŸš€ ä¸€é”®è£å‰ªå…¨éƒ¨å¹¶ä¸‹è½½
        </button>
    </div>

    <div id="status">çŠ¶æ€: å°±ç»ª</div>

    <script>
        // ç²¾çµå›¾é…ç½®
        const SPRITES = {
            characters: {
                path: '../PNG/è§’è‰²ï¼Œæ€ªç‰©.png',
                spriteWidth: 16,
                spriteHeight: 16,
                cols: 10,
                rows: 6
            },
            bosses: {
                path: '../PNG/BOSS.png',
                spriteWidth: 32,
                spriteHeight: 32,
                cols: 5,
                rows: 2
            },
            weapons: {
                path: '../PNG/å·¥å…·æ­¦å™¨.png',
                spriteWidth: 16,
                spriteHeight: 16,
                cols: 10,
                rows: 6
            }
        };

        // è§’è‰²æ˜ å°„ - åŸºäºç²¾çµå›¾å®é™…ä½ç½®
        const PLAYERS = {
            warrior: { row: 0, col: 5, name: 'æˆ˜å£«' },
            mage: { row: 2, col: 5, name: 'æ³•å¸ˆ' },
            assassin: { row: 3, col: 3, name: 'åˆºå®¢' },
            ranger: { row: 1, col: 7, name: 'æ¸¸ä¾ ' },
            summoner: { row: 4, col: 2, name: 'å¬å”¤å¸ˆ' },
            knight: { row: 0, col: 6, name: 'éª‘å£«' },
            paladin: { row: 1, col: 5, name: 'åœ£éª‘å£«' },
            necromancer: { row: 2, col: 3, name: 'æ­»çµæ³•å¸ˆ' }
        };

        // æ•Œäººæ˜ å°„ - æ‰©å……æ•Œäººç§ç±»
        const ENEMIES = {
            // æ™®é€šæ•Œäºº (normal)
            skeleton: { row: 0, col: 0, name: 'éª·é«…', type: 'normal' },
            greenBlob: { row: 0, col: 2, name: 'ç»¿è‰²å²è±å§†', type: 'normal' },
            blueSlime: { row: 4, col: 0, name: 'è“è‰²å²è±å§†', type: 'normal' },
            rat: { row: 4, col: 4, name: 'è€é¼ ', type: 'normal' },
            snake: { row: 4, col: 5, name: 'æ¯’è›‡', type: 'normal' },
            bat: { row: 0, col: 1, name: 'è™è ', type: 'normal' },
            spider: { row: 4, col: 6, name: 'èœ˜è››', type: 'normal' },
            zombie: { row: 1, col: 0, name: 'åƒµå°¸', type: 'normal' },

            // å¿«é€Ÿæ•Œäºº (fast)
            redImp: { row: 2, col: 0, name: 'çº¢è‰²å°é¬¼', type: 'fast' },
            redDevil: { row: 3, col: 1, name: 'çº¢è‰²æ¶é­”', type: 'fast' },
            blackCat: { row: 4, col: 7, name: 'é»‘çŒ«', type: 'fast' },
            wolf: { row: 4, col: 1, name: 'ç°ç‹¼', type: 'fast' },
            ghost: { row: 1, col: 1, name: 'å¹½çµ', type: 'fast' },
            shadowFiend: { row: 3, col: 0, name: 'æš—å½±é­”', type: 'fast' },

            // å¦å…‹æ•Œäºº (tank)
            stoneGolem: { row: 2, col: 7, name: 'çŸ³å¤´å‚€å„¡', type: 'tank' },
            orc: { row: 1, col: 3, name: 'å…½äººæˆ˜å£«', type: 'tank' },
            greenOrc: { row: 0, col: 4, name: 'ç»¿çš®å…½äºº', type: 'tank' },
            troll: { row: 1, col: 2, name: 'å·¨é­”', type: 'tank' },
            ogre: { row: 2, col: 2, name: 'é£Ÿäººé­”', type: 'tank' },
            ironGolem: { row: 3, col: 2, name: 'é“å‚€å„¡', type: 'tank' },

            // ç²¾è‹±æ•Œäºº (elite)
            demon: { row: 0, col: 3, name: 'æ¶é­”', type: 'elite' },
            hornedDemon: { row: 2, col: 4, name: 'è§’é­”', type: 'elite' },
            fireMan: { row: 1, col: 4, name: 'ç«ç„°å…ƒç´ ', type: 'elite' },
            smallDragon: { row: 3, col: 7, name: 'å¹¼é¾™', type: 'elite' },
            darkKnight: { row: 0, col: 7, name: 'é»‘æš—éª‘å£«', type: 'elite' },
            lich: { row: 2, col: 1, name: 'å·«å¦–', type: 'elite' },
            vampire: { row: 4, col: 3, name: 'å¸è¡€é¬¼', type: 'elite' },
            warlock: { row: 3, col: 4, name: 'æœ¯å£«', type: 'elite' }
        };

        // Bossæ˜ å°„
        const BOSSES = {
            bear: { row: 0, col: 0, name: 'çº¢ç†Šæ€ª' },
            frog: { row: 0, col: 1, name: 'é’è›™ç‹' },
            eyeball: { row: 0, col: 2, name: 'çœ¼çƒæ€ª' },
            flame: { row: 0, col: 3, name: 'ç«ç„°é­”' },
            dragon: { row: 0, col: 4, name: 'ç»¿é¾™' },
            beetle: { row: 1, col: 0, name: 'è“ç”²è™«' },
            spider: { row: 1, col: 1, name: 'æ¯’èœ˜è››' },
            snakeBoss: { row: 1, col: 2, name: 'è›‡å¦–' },
            oneEyeDemon: { row: 1, col: 3, name: 'ç‹¬çœ¼é­”' },
            dragonHead: { row: 1, col: 4, name: 'é¾™é¦–' }
        };

        // æ­¦å™¨æ˜ å°„ - æ‰©å……æ­¦å™¨ç§ç±»
        const WEAPONS = {
            // è¿‘æˆ˜æ­¦å™¨
            dagger: { row: 0, col: 0, name: 'åŒ•é¦–' },
            sword: { row: 0, col: 1, name: 'é•¿å‰‘' },
            holyBlade: { row: 0, col: 2, name: 'åœ£å‰‘' },
            axe: { row: 0, col: 5, name: 'æˆ˜æ–§' },
            shadowBlade: { row: 1, col: 1, name: 'æš—å½±åˆƒ' },
            bloodAxe: { row: 1, col: 5, name: 'å—œè¡€æ–§' },
            hammer: { row: 0, col: 6, name: 'æˆ˜é”¤' },
            spear: { row: 0, col: 7, name: 'é•¿çŸ›' },
            scythe: { row: 1, col: 6, name: 'æ­»ç¥é•°åˆ€' },
            katana: { row: 1, col: 0, name: 'æ­¦å£«åˆ€' },

            // æ³•æ–
            staff: { row: 0, col: 4, name: 'æ³•æ–' },
            arcaneStaff: { row: 1, col: 4, name: 'å¥¥æœ¯æ³•æ–' },
            fireball: { row: 2, col: 3, name: 'ç«çƒæ–' },
            inferno: { row: 2, col: 4, name: 'ç‚¼ç‹±æ–' },
            iceStaff: { row: 2, col: 5, name: 'å†°éœœæ³•æ–' },
            lightningStaff: { row: 2, col: 6, name: 'é›·ç”µæ³•æ–' },
            necroStaff: { row: 1, col: 3, name: 'æ­»çµæ³•æ–' },

            // è¿œç¨‹æ­¦å™¨
            bow: { row: 1, col: 8, name: 'å¼“' },
            phoenixBow: { row: 0, col: 8, name: 'å‡¤å‡°å¼“' },
            crossbow: { row: 1, col: 9, name: 'å¼©' },
            longbow: { row: 0, col: 9, name: 'é•¿å¼“' },

            // ç‰¹æ®Šæ­¦å™¨
            wand: { row: 0, col: 3, name: 'é­”æ–' },
            scepter: { row: 1, col: 2, name: 'æƒæ–' },
            orb: { row: 2, col: 0, name: 'é­”æ³•çƒ' },
            tome: { row: 2, col: 1, name: 'é­”æ³•ä¹¦' },
            whip: { row: 1, col: 7, name: 'é­å­' }
        };

        // é“å…·æ˜ å°„ - æ‰©å……é“å…·ç§ç±»
        const ITEMS = {
            // è¯æ°´
            healthPotion: { row: 4, col: 0, name: 'ç”Ÿå‘½è¯æ°´' },
            manaPotion: { row: 4, col: 1, name: 'é­”æ³•è¯æ°´' },
            speedPotion: { row: 4, col: 2, name: 'é€Ÿåº¦è¯æ°´' },
            strengthPotion: { row: 4, col: 3, name: 'åŠ›é‡è¯æ°´' },
            poisonPotion: { row: 4, col: 4, name: 'æ¯’è¯' },

            // å®çŸ³
            ruby: { row: 3, col: 6, name: 'çº¢å®çŸ³' },
            emerald: { row: 3, col: 7, name: 'ç»¿å®çŸ³' },
            sapphire: { row: 3, col: 8, name: 'è“å®çŸ³' },
            diamond: { row: 3, col: 9, name: 'é’»çŸ³' },
            amethyst: { row: 4, col: 5, name: 'ç´«æ°´æ™¶' },
            topaz: { row: 3, col: 5, name: 'é»„ç‰' },

            // è´§å¸
            coin: { row: 5, col: 9, name: 'é‡‘å¸' },
            coinBag: { row: 4, col: 9, name: 'é’±è¢‹' },
            goldBar: { row: 5, col: 8, name: 'é‡‘æ¡' },

            // é’¥åŒ™å’Œå·è½´
            key: { row: 5, col: 0, name: 'é’¥åŒ™' },
            goldenKey: { row: 5, col: 1, name: 'é‡‘é’¥åŒ™' },
            scroll: { row: 2, col: 9, name: 'å·è½´' },
            magicScroll: { row: 3, col: 0, name: 'é­”æ³•å·è½´' },

            // è£…å¤‡
            shield: { row: 2, col: 7, name: 'ç›¾ç‰Œ' },
            helmet: { row: 2, col: 8, name: 'å¤´ç›”' },
            ring: { row: 4, col: 6, name: 'æˆ’æŒ‡' },
            necklace: { row: 4, col: 7, name: 'é¡¹é“¾' },
            amulet: { row: 4, col: 8, name: 'æŠ¤èº«ç¬¦' },
            gloves: { row: 3, col: 1, name: 'æ‰‹å¥—' },
            boots: { row: 3, col: 2, name: 'é´å­' },
            armor: { row: 3, col: 3, name: 'é“ ç”²' },
            cape: { row: 3, col: 4, name: 'æŠ«é£' },

            // å…¶ä»–é“å…·
            bomb: { row: 0, col: 6, name: 'ç‚¸å¼¹' },
            torch: { row: 5, col: 2, name: 'ç«æŠŠ' },
            map: { row: 5, col: 3, name: 'åœ°å›¾' },
            compass: { row: 5, col: 4, name: 'æŒ‡å—é’ˆ' },
            hourglass: { row: 5, col: 5, name: 'æ²™æ¼' },
            crystal: { row: 5, col: 6, name: 'æ°´æ™¶' },
            skull: { row: 5, col: 7, name: 'éª·é«…å¤´' },
            heart: { row: 0, col: 7, name: 'å¿ƒè„' },
            feather: { row: 0, col: 8, name: 'ç¾½æ¯›' },
            bone: { row: 0, col: 9, name: 'éª¨å¤´' }
        };

        // åŠ è½½å›¾ç‰‡
        function loadImage(src) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => resolve(img);
                img.onerror = reject;
                img.src = src;
            });
        }

        // è£å‰ªå•ä¸ªç²¾çµ
        function extractSprite(img, config, row, col, scale = 4) {
            const canvas = document.createElement('canvas');
            canvas.width = config.spriteWidth * scale;
            canvas.height = config.spriteHeight * scale;
            const ctx = canvas.getContext('2d');
            ctx.imageSmoothingEnabled = false;

            ctx.drawImage(
                img,
                col * config.spriteWidth,
                row * config.spriteHeight,
                config.spriteWidth,
                config.spriteHeight,
                0, 0,
                canvas.width, canvas.height
            );

            return canvas;
        }

        // åˆ›å»ºä¸‹è½½é“¾æ¥
        function createDownloadLink(canvas, filename) {
            const link = document.createElement('a');
            link.href = canvas.toDataURL('image/png');
            link.download = filename;
            link.className = 'download-link';
            link.textContent = 'ä¸‹è½½';
            return link;
        }

        // æ˜¾ç¤ºé¢„è§ˆ
        function showPreview(containerId, sprites, category) {
            const container = document.getElementById(containerId);
            container.innerHTML = '';

            sprites.forEach(item => {
                const div = document.createElement('div');
                div.className = 'sprite-item';
                div.appendChild(item.canvas);

                const nameP = document.createElement('p');
                nameP.textContent = `${item.name} (${item.id})`;
                div.appendChild(nameP);

                const link = createDownloadLink(item.canvas, `${item.id}.png`);
                div.appendChild(link);

                container.appendChild(div);
            });
        }

        // è£å‰ªè§’è‰²
        async function extractPlayers() {
            updateStatus('æ­£åœ¨è£å‰ªè§’è‰²ç²¾çµ...');
            try {
                const img = await loadImage(SPRITES.characters.path);
                const sprites = [];

                for (const [id, info] of Object.entries(PLAYERS)) {
                    const canvas = extractSprite(img, SPRITES.characters, info.row, info.col);
                    sprites.push({ id, name: info.name, canvas });
                }

                showPreview('playersPreview', sprites, 'players');
                updateStatus(`è§’è‰²ç²¾çµè£å‰ªå®Œæˆï¼å…± ${sprites.length} ä¸ª`);
                return sprites;
            } catch (e) {
                updateStatus('é”™è¯¯: ' + e.message);
            }
        }

        // è£å‰ªæ•Œäºº
        async function extractEnemies() {
            updateStatus('æ­£åœ¨è£å‰ªæ•Œäººç²¾çµ...');
            try {
                const img = await loadImage(SPRITES.characters.path);
                const sprites = [];

                for (const [id, info] of Object.entries(ENEMIES)) {
                    const canvas = extractSprite(img, SPRITES.characters, info.row, info.col);
                    sprites.push({ id, name: info.name, type: info.type, canvas });
                }

                showPreview('enemiesPreview', sprites, 'enemies');
                updateStatus(`æ•Œäººç²¾çµè£å‰ªå®Œæˆï¼å…± ${sprites.length} ä¸ª`);
                return sprites;
            } catch (e) {
                updateStatus('é”™è¯¯: ' + e.message);
            }
        }

        // è£å‰ªBoss
        async function extractBosses() {
            updateStatus('æ­£åœ¨è£å‰ªBossç²¾çµ...');
            try {
                const img = await loadImage(SPRITES.bosses.path);
                const sprites = [];

                for (const [id, info] of Object.entries(BOSSES)) {
                    const canvas = extractSprite(img, SPRITES.bosses, info.row, info.col, 2);
                    sprites.push({ id, name: info.name, canvas });
                }

                showPreview('bossesPreview', sprites, 'bosses');
                updateStatus(`Bossç²¾çµè£å‰ªå®Œæˆï¼å…± ${sprites.length} ä¸ª`);
                return sprites;
            } catch (e) {
                updateStatus('é”™è¯¯: ' + e.message);
            }
        }

        // è£å‰ªæ­¦å™¨
        async function extractWeapons() {
            updateStatus('æ­£åœ¨è£å‰ªæ­¦å™¨ç²¾çµ...');
            try {
                const img = await loadImage(SPRITES.weapons.path);
                const sprites = [];

                for (const [id, info] of Object.entries(WEAPONS)) {
                    const canvas = extractSprite(img, SPRITES.weapons, info.row, info.col);
                    sprites.push({ id, name: info.name, canvas });
                }

                showPreview('weaponsPreview', sprites, 'weapons');
                updateStatus(`æ­¦å™¨ç²¾çµè£å‰ªå®Œæˆï¼å…± ${sprites.length} ä¸ª`);
                return sprites;
            } catch (e) {
                updateStatus('é”™è¯¯: ' + e.message);
            }
        }

        // è£å‰ªé“å…·
        async function extractItems() {
            updateStatus('æ­£åœ¨è£å‰ªé“å…·ç²¾çµ...');
            try {
                const img = await loadImage(SPRITES.weapons.path);
                const sprites = [];

                for (const [id, info] of Object.entries(ITEMS)) {
                    const canvas = extractSprite(img, SPRITES.weapons, info.row, info.col);
                    sprites.push({ id, name: info.name, canvas });
                }

                showPreview('itemsPreview', sprites, 'items');
                updateStatus(`é“å…·ç²¾çµè£å‰ªå®Œæˆï¼å…± ${sprites.length} ä¸ª`);
                return sprites;
            } catch (e) {
                updateStatus('é”™è¯¯: ' + e.message);
            }
        }

        // ä¸€é”®è£å‰ªå…¨éƒ¨
        async function extractAll() {
            updateStatus('å¼€å§‹æ‰¹é‡è£å‰ªæ‰€æœ‰ç²¾çµ...');

            await extractPlayers();
            await extractEnemies();
            await extractBosses();
            await extractWeapons();
            await extractItems();

            updateStatus('å…¨éƒ¨è£å‰ªå®Œæˆï¼è¯·ç‚¹å‡»å„ç²¾çµä¸‹æ–¹çš„"ä¸‹è½½"æŒ‰é’®ä¿å­˜æ–‡ä»¶ã€‚');
        }

        function updateStatus(msg) {
            document.getElementById('status').textContent = 'çŠ¶æ€: ' + msg;
        }
    </script>
</body>
</html>
